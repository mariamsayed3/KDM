# spatial_transcriptomics_teacher.yml
# Configuration for training the teacher model

name: 'spatial_transcriptomics_teacher'
seed: 42

# Global parameters
dataset: 'spatial_transcriptomics'
gpu_id: [0]

train_params:
  dataset: 'spatial_transcriptomics'
  dataset_dir: 'C:/Users/maria/Documents/Masters_24/New_Models/KDM_Model/KDM/bioDataset3'  # Update this path
  batch_size: 16
  n_epochs: 150
  num_workers: 4
  save_dir: ''  # Will be auto-generated with timestamp
  early_stop: 30
  ignore_index: 0
  add_cm_labels: 1  # Show confusion matrix labels

model_params:
  name: 'SGR_Net'  # or your teacher model name
  n_bands: 136  # Number of gene expression features
  classes: null  # Auto-detect classes (or specify [1, 2, 3, 4, 5] if known)
  n_heads: 5  # Multiple heads for progressive learning
  nf_enc: [64, 128, 256, 512, 1024]  # Encoder features
  nf_dec: [64, 32, 32, 16, 16, 8]    # Decoder features  
  do_batchnorm: true
  encoder_name: 'resnet50'
  
  # Loss weights for SpatialTranscriptomicsLoss
  ce_weight: 1.0
  dice_weight: 0.5
  focal_weight: 0.3
  
  # Knowledge distillation weights (for multi-head training)
  feat_weight: 0.5
  resp_weight: 0.5
  student_weight: 1.0
  
  ignore_index: 0

optimizer:
  type: 'Adam'
  args:
    lr: 0.0001
    weight_decay: 0.00001

# Use specialized loss for spatial transcriptomics
loss: 'SpatialTranscriptomicsLoss'  # or 'KDLoss' for multi-head training

# Metrics with auto-class detection
metric: 'MeanIoU'

# Resume training if needed
resume: false

tags: 
  - 'spatial_transcriptomics'
  - 'teacher'
  - 'multi_head'